<!-- This is a simple sdl file for zesto, 
one zesto core is connected to one simple 
cache, which is further connected to simple 
mc through iris nic and iris router-->

<!-- Due to a bug of clock registration in sst core ,
iris router should has the same frequency with another
component in the same rank-->

<?xml version=1.0?>

<sdl version=2.0/>

<config>
  stopAtCycle=0.5ms
  partitioner=self
  run-mode=both
</config>

<variables>
  <link_lat>1ns</link_lat>
</variables>

<param_include>
  <cache_params>
    <size>524288</size>
    <assoc>4</assoc>
    <block_size>32</block_size>
    <hit_time>2</hit_time>
    <lookup_time>5</lookup_time>
    <mc_node_ids>1</mc_node_ids>
  </cache_params>

  <mc_params>
    <clockFreq>300MHz</clockFreq>  
    <latency>50</latency>
  </mc_params>

  <iris_nic_params>
    <event_type>mem_req</event_type>
    <num_vc>2</num_vc>
    <clock>500MHz</clock>
    <Node2RouterQSize_flits>30</Node2RouterQSize_flits>
  </iris_nic_params> 

  <iris_rtr_params>
    <credits> 30 </credits>
    <benchmarks> 3 </benchmarks>
    <vcs> 4 </vcs>
    <no_nodes> 2 </no_nodes>
    <grid_size> 2 </grid_size>
  </iris_rtr_params>
</param_include>

<sst>

  <component name=0.core type=zesto.qsimclient_core_t rank=0>
      <params>
        <nodeId>0</nodeId>
        <clockFreq>1 GHz</clockFreq>
        <configFile>core_config/6.cfg</configFile>
        <stateFile>qsimTrace/state.4</stateFile>
		<benchmark>qsimTrace/fft.tar</benchmark>
      </params>
      <link name=0.core2cache benchmark=cache_link latency=$link_lat/>
  </component>

  <component name=0.cache type=zesto.simpleCache rank=1>
      <params include=cache_params>
        <nodeId>0</nodeId>
        <clockFreq>1 GHz</clockFreq> 
      </params>
      <link name=0.core2cache benchmark=link_upper latency=$link_lat/>
      <link name=0.cache2nic benchmark=link_lower latency=$link_lat/>
  </component>

  <component name=0.nic type=zesto.irisNic rank=3>
    <params include=iris_nic_params>
      <id>0</id>
    </params>
    <link name=0.cache2nic benchmark=terminal latency=$link_lat/>
    <link name=0.nic2rtr benchmark=rtr latency=$link_lat/>
  </component>

  <component name=0.rtr type=iris.router rank=3>
    <params include=iris_rtr_params>
      <id>0</id>
    </params>
    <link name=0.nic2rtr benchmark=nic latency=$link_lat/>
    <link name=xr2r.0.0.1 benchmark=xPos latency=$link_lat/>
    <link name=xr2r.0.0.0 benchmark=xNeg latency=$link_lat/>
  </component>

  <component name=1.mc type=zesto.simpleMC rank=2>
    <params include=mc_params>
      <nodeId>1</nodeId>
    </params>
    <link name=1.mc2nic benchmark=link_ni latency=$link_lat/>
  </component>

  <component name=1.nic type=zesto.irisNic rank=3>
    <params include=iris_nic_params>
      <id>1</id>
    </params>
    <link name=1.mc2nic benchmark=terminal latency=$link_lat/>
    <link name=1.nic2rtr benchmark=rtr latency=$link_lat/>
  </component>

  <component name=1.rtr type=iris.router rank=3>
    <params include=iris_rtr_params>
      <id>1</id>
    </params>
    <link name=1.nic2rtr benchmark=nic latency=$link_lat/>
    <link name=xr2r.0.0.0 benchmark=xPos latency=$link_lat/>
    <link name=xr2r.0.0.1 benchmark=xNeg latency=$link_lat/>
  </component>


</sst>
